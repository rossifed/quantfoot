{"metadata": {"dbt_schema_version": "https://schemas.getdbt.com/dbt/run-results/v6.json", "dbt_version": "1.10.15", "generated_at": "2025-12-07T08:17:00.059134Z", "invocation_id": "4ed887b2-b474-4a5a-ae2f-ec6e4497032f", "invocation_started_at": "2025-12-07T08:16:58.375888Z", "env": {}}, "results": [{"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-07T08:16:59.529847Z", "completed_at": "2025-12-07T08:16:59.607304Z"}, {"name": "execute", "started_at": "2025-12-07T08:16:59.613400Z", "completed_at": "2025-12-07T08:16:59.749429Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.2436511516571045, "adapter_response": {"_message": "CREATE VIEW", "code": "CREATE VIEW", "rows_affected": -1}, "message": "CREATE VIEW", "failures": null, "unique_id": "model.quantfoot.stg_teams", "compiled": true, "compiled_code": "\n\nwith source as (\n    select * from \"football_data\".\"raw\".\"raw_team_info\"\n),\n\nparsed as (\n    select\n        team_id,\n        team_name,\n        venue_id,\n        venue_name,\n        \n        -- Parse team details from JSON\n        (data->'team'->>'code')::text as team_code,\n        (data->'team'->>'country')::text as team_country,\n        (data->'team'->>'founded')::int as team_founded,\n        (data->'team'->>'national')::boolean as is_national_team,\n        (data->'team'->>'logo')::text as team_logo,\n        \n        -- Parse venue details\n        (data->'venue'->>'address')::text as venue_address,\n        (data->'venue'->>'city')::text as venue_city,\n        (data->'venue'->>'capacity')::int as venue_capacity,\n        (data->'venue'->>'surface')::text as venue_surface,\n        (data->'venue'->>'image')::text as venue_image,\n        \n        -- Metadata\n        current_timestamp as dbt_loaded_at\n        \n    from source\n)\n\nselect * from parsed", "relation_name": "\"football_data\".\"staging\".\"stg_teams\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-07T08:16:59.533386Z", "completed_at": "2025-12-07T08:16:59.540983Z"}, {"name": "execute", "started_at": "2025-12-07T08:16:59.541841Z", "completed_at": "2025-12-07T08:16:59.759517Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.2535281181335449, "adapter_response": {"_message": "CREATE VIEW", "code": "CREATE VIEW", "rows_affected": -1}, "message": "CREATE VIEW", "failures": null, "unique_id": "model.quantfoot.stg_leagues", "compiled": true, "compiled_code": "\n\nwith source as (\n    select * from \"football_data\".\"raw\".\"raw_leagues\"\n),\n\nparsed as (\n    select\n        league_id,\n        league_name,\n        country_name,\n        season,\n        \n        -- Parse league details from JSON\n        (data->'league'->>'type')::text as league_type,\n        (data->'league'->>'logo')::text as league_logo,\n        \n        -- Parse country details\n        (data->'country'->>'code')::text as country_code,\n        (data->'country'->>'flag')::text as country_flag,\n        \n        -- Parse season info from the seasons array\n        -- Note: Each row already has a specific season extracted\n        (data->'seasons'->0->>'start')::date as season_start,\n        (data->'seasons'->0->>'end')::date as season_end,\n        (data->'seasons'->0->>'current')::boolean as is_current_season,\n        \n        -- Metadata\n        current_timestamp as dbt_loaded_at\n        \n    from source\n)\n\nselect * from parsed", "relation_name": "\"football_data\".\"staging\".\"stg_leagues\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-07T08:16:59.525356Z", "completed_at": "2025-12-07T08:16:59.557085Z"}, {"name": "execute", "started_at": "2025-12-07T08:16:59.569377Z", "completed_at": "2025-12-07T08:16:59.780177Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.27341198921203613, "adapter_response": {"_message": "CREATE VIEW", "code": "CREATE VIEW", "rows_affected": -1}, "message": "CREATE VIEW", "failures": null, "unique_id": "model.quantfoot.stg_fixtures", "compiled": true, "compiled_code": "\n\nwith source as (\n    select * from \"football_data\".\"raw\".\"raw_fixtures\"\n),\n\nparsed as (\n    select\n        fixture_id,\n        fixture_date,\n        team_id,\n        season,\n        status,\n        \n        -- Parse JSON fields\n        (data->>'fixture')::jsonb as fixture_json,\n        (data->>'league')::jsonb as league_json,\n        (data->>'teams')::jsonb as teams_json,\n        (data->>'goals')::jsonb as goals_json,\n        (data->>'score')::jsonb as score_json,\n        \n        -- Extract fixture details\n        (data->'fixture'->>'referee')::text as referee,\n        (data->'fixture'->>'timezone')::text as timezone,\n        (data->'fixture'->>'timestamp')::bigint as timestamp_unix,\n        to_timestamp((data->'fixture'->>'timestamp')::bigint) as fixture_datetime,\n        \n        -- Extract venue\n        (data->'fixture'->'venue'->>'id')::int as venue_id,\n        (data->'fixture'->'venue'->>'name')::text as venue_name,\n        (data->'fixture'->'venue'->>'city')::text as venue_city,\n        \n        -- Extract status\n        (data->'fixture'->'status'->>'long')::text as status_long,\n        (data->'fixture'->'status'->>'short')::text as status_short,\n        (data->'fixture'->'status'->>'elapsed')::int as minutes_elapsed,\n        \n        -- Extract league\n        (data->'league'->>'id')::int as league_id,\n        (data->'league'->>'name')::text as league_name,\n        (data->'league'->>'country')::text as league_country,\n        (data->'league'->>'logo')::text as league_logo,\n        (data->'league'->>'flag')::text as league_flag,\n        (data->'league'->>'season')::int as league_season,\n        (data->'league'->>'round')::text as league_round,\n        \n        -- Extract teams\n        (data->'teams'->'home'->>'id')::int as home_team_id,\n        (data->'teams'->'home'->>'name')::text as home_team_name,\n        (data->'teams'->'home'->>'logo')::text as home_team_logo,\n        (data->'teams'->'home'->>'winner')::boolean as home_team_winner,\n        \n        (data->'teams'->'away'->>'id')::int as away_team_id,\n        (data->'teams'->'away'->>'name')::text as away_team_name,\n        (data->'teams'->'away'->>'logo')::text as away_team_logo,\n        (data->'teams'->'away'->>'winner')::boolean as away_team_winner,\n        \n        -- Extract goals\n        (data->'goals'->>'home')::int as goals_home,\n        (data->'goals'->>'away')::int as goals_away,\n        \n        -- Extract score details\n        (data->'score'->'halftime'->>'home')::int as halftime_home,\n        (data->'score'->'halftime'->>'away')::int as halftime_away,\n        (data->'score'->'fulltime'->>'home')::int as fulltime_home,\n        (data->'score'->'fulltime'->>'away')::int as fulltime_away,\n        (data->'score'->'extratime'->>'home')::int as extratime_home,\n        (data->'score'->'extratime'->>'away')::int as extratime_away,\n        (data->'score'->'penalty'->>'home')::int as penalty_home,\n        (data->'score'->'penalty'->>'away')::int as penalty_away,\n        \n        -- Metadata\n        current_timestamp as dbt_loaded_at\n        \n    from source\n)\n\nselect * from parsed", "relation_name": "\"football_data\".\"staging\".\"stg_fixtures\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-07T08:16:59.516332Z", "completed_at": "2025-12-07T08:16:59.568513Z"}, {"name": "execute", "started_at": "2025-12-07T08:16:59.580071Z", "completed_at": "2025-12-07T08:16:59.783093Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.2800009250640869, "adapter_response": {"_message": "CREATE VIEW", "code": "CREATE VIEW", "rows_affected": -1}, "message": "CREATE VIEW", "failures": null, "unique_id": "model.quantfoot.stg_players", "compiled": true, "compiled_code": "\n\nwith source as (\n    select * from \"football_data\".\"raw\".\"raw_players\"\n),\n\nparsed as (\n    select\n        player_id,\n        player_name,\n        team_id,\n        position,\n        number as jersey_number,\n        \n        -- Parse additional fields from JSON\n        (data->>'age')::int as age,\n        (data->>'photo')::text as photo_url,\n        \n        -- Metadata\n        current_timestamp as dbt_loaded_at\n        \n    from source\n)\n\nselect * from parsed", "relation_name": "\"football_data\".\"staging\".\"stg_players\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-07T08:16:59.785372Z", "completed_at": "2025-12-07T08:16:59.794201Z"}, {"name": "execute", "started_at": "2025-12-07T08:16:59.795862Z", "completed_at": "2025-12-07T08:16:59.873866Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.09744620323181152, "adapter_response": {"_message": "CREATE VIEW", "code": "CREATE VIEW", "rows_affected": -1}, "message": "CREATE VIEW", "failures": null, "unique_id": "model.quantfoot.stg_venues", "compiled": true, "compiled_code": "\n\nwith source as (\n    select * from \"football_data\".\"raw\".\"raw_venues\"\n),\n\nparsed as (\n    select\n        venue_id,\n        venue_name,\n        team_id,\n        \n        -- Parse venue details from JSON\n        (data->>'address')::text as address,\n        (data->>'city')::text as city,\n        (data->>'capacity')::int as capacity,\n        (data->>'surface')::text as surface,\n        (data->>'image')::text as image_url,\n        \n        -- Metadata\n        current_timestamp as dbt_loaded_at\n        \n    from source\n)\n\nselect * from parsed", "relation_name": "\"football_data\".\"staging\".\"stg_venues\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-07T08:16:59.803536Z", "completed_at": "2025-12-07T08:16:59.809929Z"}, {"name": "execute", "started_at": "2025-12-07T08:16:59.811882Z", "completed_at": "2025-12-07T08:16:59.948587Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.1490163803100586, "adapter_response": {"_message": "SELECT 61", "code": "SELECT", "rows_affected": 61}, "message": "SELECT 61", "failures": null, "unique_id": "model.quantfoot.players", "compiled": true, "compiled_code": "\n\nwith players as (\n    select * from \"football_data\".\"staging\".\"stg_players\"\n),\n\nteams as (\n    select * from \"football_data\".\"staging\".\"stg_teams\"\n),\n\nfinal as (\n    select\n        p.player_id,\n        p.player_name,\n        p.age,\n        p.position,\n        p.jersey_number,\n        p.photo_url,\n        \n        -- Team info\n        p.team_id,\n        t.team_name,\n        t.team_code,\n        t.team_country,\n        \n        -- Metadata\n        current_timestamp as dbt_updated_at\n        \n    from players p\n    left join teams t on p.team_id = t.team_id\n)\n\nselect * from final", "relation_name": "\"football_data\".\"marts\".\"players\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-07T08:16:59.906155Z", "completed_at": "2025-12-07T08:16:59.918797Z"}, {"name": "execute", "started_at": "2025-12-07T08:16:59.922191Z", "completed_at": "2025-12-07T08:16:59.995329Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.1134793758392334, "adapter_response": {"_message": "SELECT 2", "code": "SELECT", "rows_affected": 2}, "message": "SELECT 2", "failures": null, "unique_id": "model.quantfoot.teams", "compiled": true, "compiled_code": "\n\nwith teams as (\n    select * from \"football_data\".\"staging\".\"stg_teams\"\n),\n\nvenues as (\n    select * from \"football_data\".\"staging\".\"stg_venues\"\n),\n\nfinal as (\n    select\n        t.team_id,\n        t.team_name,\n        t.team_code,\n        t.team_country,\n        t.team_founded,\n        t.is_national_team,\n        t.team_logo,\n        \n        -- Venue info\n        t.venue_id,\n        v.venue_name,\n        v.address as venue_address,\n        v.city as venue_city,\n        v.capacity as venue_capacity,\n        v.surface as venue_surface,\n        \n        -- Metadata\n        current_timestamp as dbt_updated_at\n        \n    from teams t\n    left join venues v on t.venue_id = v.venue_id\n)\n\nselect * from final", "relation_name": "\"football_data\".\"marts\".\"teams\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-07T08:16:59.900643Z", "completed_at": "2025-12-07T08:16:59.910650Z"}, {"name": "execute", "started_at": "2025-12-07T08:16:59.912303Z", "completed_at": "2025-12-07T08:17:00.033752Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.15350890159606934, "adapter_response": {"_message": "SELECT 57", "code": "SELECT", "rows_affected": 57}, "message": "SELECT 57", "failures": null, "unique_id": "model.quantfoot.fixtures", "compiled": true, "compiled_code": "\n\nwith fixtures as (\n    select * from \"football_data\".\"staging\".\"stg_fixtures\"\n),\n\nteams as (\n    select * from \"football_data\".\"staging\".\"stg_teams\"\n),\n\nvenues as (\n    select * from \"football_data\".\"staging\".\"stg_venues\"\n),\n\nleagues as (\n    select * from \"football_data\".\"staging\".\"stg_leagues\"\n),\n\nfinal as (\n    select\n        -- Fixture identifiers\n        f.fixture_id,\n        f.fixture_datetime,\n        f.fixture_date,\n        f.season,\n        \n        -- Status\n        f.status,\n        f.status_long,\n        f.minutes_elapsed,\n        \n        -- League info\n        f.league_id,\n        l.league_name,\n        l.league_type,\n        l.country_name as league_country,\n        f.league_round,\n        \n        -- Venue info\n        f.venue_id,\n        v.venue_name,\n        v.city as venue_city,\n        v.capacity as venue_capacity,\n        \n        -- Home team\n        f.home_team_id,\n        ht.team_name as home_team_name,\n        ht.team_code as home_team_code,\n        f.home_team_winner,\n        \n        -- Away team\n        f.away_team_id,\n        at.team_name as away_team_name,\n        at.team_code as away_team_code,\n        f.away_team_winner,\n        \n        -- Score\n        f.goals_home,\n        f.goals_away,\n        f.halftime_home,\n        f.halftime_away,\n        f.fulltime_home,\n        f.fulltime_away,\n        \n        -- Match result\n        case\n            when f.home_team_winner = true then 'H'\n            when f.away_team_winner = true then 'A'\n            when f.goals_home = f.goals_away and f.status_short = 'FT' then 'D'\n            else null\n        end as result,\n        \n        -- Goal difference\n        case\n            when f.goals_home is not null and f.goals_away is not null\n            then f.goals_home - f.goals_away\n            else null\n        end as goal_difference,\n        \n        -- Total goals\n        case\n            when f.goals_home is not null and f.goals_away is not null\n            then f.goals_home + f.goals_away\n            else null\n        end as total_goals,\n        \n        -- Match info\n        f.referee,\n        \n        -- Metadata\n        current_timestamp as dbt_updated_at\n        \n    from fixtures f\n    left join teams ht on f.home_team_id = ht.team_id\n    left join teams at on f.away_team_id = at.team_id\n    left join venues v on f.venue_id = v.venue_id\n    left join leagues l on f.league_id = l.league_id and f.season = l.season\n)\n\nselect * from final", "relation_name": "\"football_data\".\"marts\".\"fixtures\"", "batch_results": null}], "elapsed_time": 0.8931019306182861, "args": {"export_saved_queries": false, "cache_selected_only": false, "log_level": "info", "strict_mode": false, "indirect_selection": "eager", "warn_error_options": {"error": [], "warn": [], "silence": []}, "target_path": "target/quantfoot_dbt_assets-8e21633-bcac36e", "use_fast_test_edges": false, "favor_state": false, "empty": false, "require_generic_test_arguments_property": true, "exclude": [], "use_colors_file": true, "require_yaml_configuration_for_mf_time_spines": false, "introspect": true, "require_explicit_package_overrides_for_builtin_materializations": true, "macro_debugging": false, "state_modified_compare_vars": false, "validate_macro_args": false, "log_format_file": "json", "print": true, "state_modified_compare_more_unrendered_values": false, "vars": {}, "write_json": true, "quiet": false, "require_resource_names_without_spaces": true, "populate_cache": true, "show_resource_report": false, "source_freshness_run_project_hooks": true, "show_all_deprecations": false, "require_all_warnings_handled_by_warn_error": false, "static_parser": true, "skip_nodes_if_on_run_start_fails": false, "resource_types": [], "printer_width": 80, "exclude_resource_types": [], "partial_parse_file_diff": true, "defer": false, "log_format": "json", "which": "build", "invocation_command": "dbt build --select staging.*+ marts.* --select fqn:*", "use_colors": true, "require_nested_cumulative_type_params": false, "log_level_file": "debug", "profiles_dir": "/app/dbt_project", "log_path": "/app/dbt_project/target/quantfoot_dbt_assets-8e21633-bcac36e", "require_batched_execution_for_custom_microbatch_strategy": false, "select": ["staging.*+", "marts.*", "fqn:*"], "project_dir": "/app/dbt_project", "include_saved_query": false, "partial_parse": true, "send_anonymous_usage_stats": false, "show": false, "upload_to_artifacts_ingest_api": false, "version_check": true, "log_file_max_bytes": 10485760}}